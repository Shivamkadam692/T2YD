<section class="hero">
  <h1 data-translate="heroTitle">Transport Goods to Your Destination With Our Network</h1>
  <p data-translate="heroSubtitle">Connect with transporters(Drivers) and shippers across the country</p>
</section>

<section class="search-container">
  <form action="/search" method="get" class="search-form">
    <input type="text" name="query" data-translate-placeholder="searchPlaceholder" placeholder="Search by location, vehicle type, or goods..." required>
    <button type="submit" data-translate="searchButton">Search <i class="fas fa-search"></i></button>
  </form>
</section>

<section>
  <h2 class="section-title" data-translate="availableLorries">Available Lorries</h2>
  <div class="card-container">
    <% lorries.forEach(lorry => { %>
      <div class="card">
        <div class="card-header">
          <%= lorry.vehicleType || 'Lorry' %> - <%= lorry.vehicleNumber %>
        </div>
        <div class="card-body">
          <div class="card-item">
            <i class="fas fa-user"></i>
            <span><strong data-translate="owner">Owner:</strong> <%= lorry.ownerName %></span>
          </div>
          <div class="card-item">
            <i class="fas fa-map-marker-alt"></i>
            <span><strong data-translate="location">Location:</strong> <%= lorry.location %></span>
          </div>
          <div class="card-item">
            <i class="fas fa-truck"></i>
            <span><strong data-translate="capacity">Capacity:</strong> <%= lorry.capacity || 'N/A' %> tons</span>
          </div>
          <div class="card-item">
            <i class="fas fa-rupee-sign"></i>
            <span><strong data-translate="rate">Rate:</strong> â‚¹<%= lorry.rate || 'Negotiable' %> <span data-translate="perKm">per km</span></span>
          </div>
          <a href="/lorries/<%= lorry._id %>" class="btn" style="margin-top: 1rem; display: block; text-align: center;" data-translate="viewDetails">
            View Details
          </a>
          <!-- Assign lorry button: redirects guests to login -->
          <% if (!locals.user) { %>
            <a href="/auth/login" class="btn btn-outline" style="margin-top: .5rem; display:block; text-align:center;" data-translate="assignLorry">Assign Lorry</a>
          <% } else { %>
            <a href="/lorries/<%= lorry._id %>" class="btn btn-outline" style="margin-top: .5rem; display:block; text-align:center;" data-translate="assignLorry">Assign Lorry</a>
          <% } %>
        </div>
      </div>
    <% }) %>
  </div>
</section>

<section>
  <h2 class="section-title" data-translate="availableDeliveries">Available Deliveries</h2>
  <div class="card-container">
    <% deliveries.forEach(delivery => { %>
      <div class="card">
        <div class="card-header">
          <%= delivery.goodsType %>
        </div>
        <div class="card-body">
          <div class="card-item">
            <i class="fas fa-box"></i>
            <span><strong data-translate="goods">Goods:</strong> <%= delivery.goodsType %></span>
          </div>
          <div class="card-item">
            <i class="fas fa-weight-hanging"></i>
            <span><strong data-translate="weight">Weight:</strong> <%= delivery.weight || 'N/A' %> kg</span>
          </div>
          <div class="card-item">
            <i class="fas fa-map-pin"></i>
            <span><strong data-translate="from">From:</strong> <%= delivery.pickupLocation %></span>
          </div>
          <div class="card-item">
            <i class="fas fa-map-marker-alt"></i>
            <span><strong data-translate="to">To:</strong> <%= delivery.dropLocation %></span>
          </div>
          <div class="card-item">
            <i class="fas fa-calendar-alt"></i>
            <span><strong data-translate="date">Date:</strong> <%= delivery.pickupDate || 'Flexible' %></span>
          </div>
          <a href="/deliveries/<%= delivery._id %>" class="btn" style="margin-top: 1rem; display: block; text-align: center;" data-translate="viewDetails">
            View Details
          </a>
          <!-- Book delivery button: guests -> login; authenticated -> go to bid page -->
          <% if (!locals.user) { %>
            <a href="/auth/login" class="btn btn-primary" style="margin-top: .5rem; display:block; text-align:center;" data-translate="bookDelivery">Book Delivery</a>
          <% } else if (locals.user.role === 'transporter' && delivery.status === 'pending') { %>
            <a href="/bid/<%= delivery._id %>" class="btn btn-primary" style="margin-top: .5rem; display:block; text-align:center;" data-translate="bookDelivery">Book Delivery</a>
          <% } %>
        </div>
      </div>
    <% }) %>
  </div>
</section>